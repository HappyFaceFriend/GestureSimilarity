import torch

cos = torch.nn.CosineSimilarity(dim=1)
cosineloss = torch.nn.CosineEmbeddingLoss()

loss2 = torch.nn.BCELoss()


a = torch.tensor([[-306.7884, -187.0211, -253.4474, -191.3489,  230.8061,  193.9029,
          194.8003,  238.0415],
        [-302.6756, -183.6815, -250.6789, -187.5549,  227.0818,  192.1698,
          193.8770,  234.6047],
        [-307.6757, -203.4904, -237.6069, -215.5045,  241.5623,  175.0470,
          169.4233,  232.3833],
        [-295.7853, -176.0422, -248.2375, -178.0843,  218.9841,  191.6398,
          196.9880,  228.8257],
        [-306.7922, -187.2137, -253.0677, -191.6884,  231.1384,  193.4911,
          193.8291,  238.1655],
        [-311.5481, -194.7704, -253.0859, -200.9805,  237.9532,  191.6469,
          188.9465,  240.9988],
        [-297.9462, -175.9681, -250.7221, -177.5417,  220.1925,  193.8142,
          199.2069,  230.8118],
        [-316.2755, -203.0422, -252.1085, -211.7240,  245.3199,  188.7827,
          182.1530,  243.7254],
        [-295.7919, -175.9022, -247.2978, -178.4506,  219.4231,  190.7488,
          195.4478,  228.8920],
        [-304.1357, -187.9445, -248.0515, -193.3526,  231.1292,  188.4450,
          187.2035,  235.1282],
        [-304.6278, -179.0199, -258.3789, -179.7719,  224.3775,  200.2435,
          206.0135,  237.2087],
        [-295.6273, -175.7801, -247.1682, -178.3809,  219.3842,  190.6367,
          194.9948,  228.9379],
        [-312.9973, -198.8050, -251.0882, -206.5428,  241.4686,  188.8335,
          183.7150,  241.3301],
        [-302.5345, -201.1739, -231.7994, -214.0324,  237.6431,  170.1349,
          166.6475,  226.4409],
        [-302.5137, -179.4430, -254.5213, -181.4074,  223.9721,  196.6875,
          201.3830,  235.0512],
        [-298.3438, -177.7315, -249.4099, -180.6731,  221.3545,  192.4035,
          197.0240,  231.1027]], dtype = torch.float32)
b = torch.tensor([[-312.4223, -195.7841, -253.4070, -202.1431,  238.9781,  191.7151,
          188.6975,  241.6030],
        [-312.9973, -198.8050, -251.0882, -206.5428,  241.4686,  188.8335,
          183.7150,  241.3301],
        [-301.9485, -206.7997, -225.3138, -223.1677,  239.9189,  162.4772,
          160.2539,  221.4066],
        [-298.5137, -177.1099, -251.5701, -178.6085,  220.5988,  194.5196,
          199.8911,  231.4760],
        [-305.1956, -180.8086, -257.2647, -182.3518,  225.9672,  198.8482,
          203.2812,  237.5815],
        [-312.4223, -195.7841, -253.4070, -202.1431,  238.9781,  191.7151,
          188.6975,  241.6030],
        [-304.5544, -196.2324, -242.6115, -204.4162,  235.8248,  181.4336,
          175.8924,  234.2017],
        [-313.9073, -198.9852, -252.4199, -206.4012,  241.9386,  190.0076,
          184.9431,  242.4690],
        [-295.3669, -172.2228, -250.5781, -172.5920,  216.9960,  194.2813,
          200.9643,  229.0751],
        [-305.0431, -190.1183, -247.4030, -196.2199,  233.0113,  187.2998,
          184.9167,  235.5156],
        [-303.5389, -182.6669, -253.0852, -185.8882,  226.4125,  194.6832,
          197.7275,  235.5463],
        [-297.1716, -178.2718, -247.4813, -181.2373,  221.3778,  190.3960,
          193.9757,  230.0025],
        [-302.5906, -181.0932, -252.9281, -183.8425,  225.3171,  194.8185,
          198.1973,  234.9041],
        [-296.3631, -177.1338, -247.9435, -180.1215,  219.7856,  191.3384,
          195.9743,  229.6449],
        [-310.5848, -192.8043, -253.3959, -198.4939,  236.2888,  192.4370,
          190.7312,  240.4541],
        [-300.4041, -174.9800, -255.9285, -175.2325,  220.2388,  198.8226,
          205.7552,  233.7452]], dtype = torch.float32)


print(cosineloss(a,b,torch.tensor([0, 0, 0])))

loss = (torch.tensor([-1,1,1])-cos(a,b)).abs().mean()



print(loss)